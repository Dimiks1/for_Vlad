@page
@model CatalogModel

@{
    ViewData["Title"] = "–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ - ToolDrop";

    // –ü–æ–ª—É—á–∞–µ–º ID —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Å–µ—Å—Å–∏–∏
    var currentUserId = 0;
    var userDataJson = HttpContext.Session.GetString("UserData");
    if (!string.IsNullOrEmpty(userDataJson))
    {
        try
        {
            var userData = System.Text.Json.JsonSerializer.Deserialize<System.Text.Json.JsonElement>(userDataJson);
            if (userData.TryGetProperty("id", out var idProperty) &&
                idProperty.ValueKind == System.Text.Json.JsonValueKind.Number)
            {
                currentUserId = idProperty.GetInt32();
            }
        }
        catch { }
    }
}

<div class="container-fluid py-4">
    <div class="row">
        <!-- Sidebar - –ö–æ—Ä–∑–∏–Ω–∞ -->
        <div class="col-lg-3">
            <div class="card shadow-sm sticky-top" style="top: 80px;">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h5>
                </div>
                <div class="card-body">
                    <!-- –ë–∞–ª–∞–Ω—Å -->
                    <div class="mb-4 p-3 bg-light rounded">
                        <small class="text-muted">–ë–∞–ª–∞–Ω—Å —Å—á—ë—Ç–∞</small>
                        <h5 class="mb-0"><span id="userBalance">–ó–∞–≥—Ä—É–∑–∫–∞...</span> ‚ÇΩ</h5>
                    </div>

                    <!-- –¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
                    <div id="cartItemsList" style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                        <p class="text-muted text-center">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
                    </div>

                    <!-- –ò—Ç–æ–≥–æ -->
                    <div class="border-top pt-3">
                        <div class="d-flex justify-content-between mb-3">
                            <strong>–ò—Ç–æ–≥–æ:</strong>
                            <strong id="cartTotal">0 ‚ÇΩ</strong>
                        </div>
                        <button class="btn btn-primary w-100 mb-2" onclick="checkout()">–ö—É–ø–∏—Ç—å</button>
                        <button class="btn btn-outline-secondary w-100" onclick="clearCart()">–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="col-lg-9">
            <!-- Search & Filter -->
            <div class="card shadow-sm mb-4">
                <div class="card-body">
                    <div class="row g-3">
                        <div class="col-md-5">
                            <input type="text" class="form-control" id="searchText" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." onkeyup="filterItems()">
                        </div>
                        <div class="col-md-4">
                            <input type="text" class="form-control" id="searchArticle" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∞—Ä—Ç–∏–∫—É–ª—É..." onkeyup="filterItems()">
                        </div>
                        <div class="col-md-3">
                            <div class="input-group">
                                <select class="form-select" id="categoryFilter" onchange="filterItems()">
                                    <option value="">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                                    <option value="Weapon">‚öîÔ∏è –û—Ä—É–∂–∏–µ</option>
                                    <option value="Armor">üõ°Ô∏è –ë—Ä–æ–Ω—è</option>
                                    <option value="Potion">üß™ –ó–µ–ª—å—è</option>
                                    <option value="Accessory">üíé –ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
                                    <option value="Other">üì¶ –î—Ä—É–≥–æ–µ</option>
                                </select>
                                <select class="form-select" id="rarityFilter" onchange="filterItems()">
                                    <option value="">–í—Å–µ —Ä–µ–¥–∫–æ—Å—Ç–∏</option>
                                    <option value="Common">‚ö™ Common</option>
                                    <option value="Uncommon">üü¢ Uncommon</option>
                                    <option value="Rare">üîµ Rare</option>
                                    <option value="Epic">üü£ Epic</option>
                                    <option value="Legendary">üü° Legendary</option>
                                    <option value="Mythical">üü† Mythical</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <button class="btn btn-success me-2" onclick="search()">üîç –ü–æ–∏—Å–∫</button>
                            <button class="btn btn-secondary" onclick="resetFilters()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
                            <button class="btn btn-outline-primary float-end" onclick="window.location.href='/myitems'">
                                üì¶ –ú–æ–∏ —Ç–æ–≤–∞—Ä—ã
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Products Grid -->
            <div id="itemsContainer" class="row g-4">
                @if (Model.GameItems != null && Model.GameItems.Any())
                {
                    @foreach (var item in Model.GameItems)
                    {
                        var isMyItem = currentUserId > 0 && item.UserId == currentUserId;

                        <div class="col-md-6 col-lg-4 game-item"
                             data-category="@item.Category"
                             data-rarity="@item.Rarity"
                             data-name="@item.Name.ToLower()"
                             data-article="@item.ItemCode.ToLower()">
                            <div class="card h-100 shadow-sm" style="transition: transform 0.3s; position: relative;">
                                <!-- –ú–µ—Ç–∫–∞ "–ú–æ–π —Ç–æ–≤–∞—Ä" -->
                                @if (isMyItem)
                                {
                                    <div class="my-item-badge">üëë –ú–æ–π —Ç–æ–≤–∞—Ä</div>
                                }

                                <!-- Image Placeholder -->
                                <div style="height: 180px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; color: white; font-size: 48px;">
                                    @GetIcon(item.Category)
                                </div>

                                <div class="card-body">
                                    <h6 class="card-title">@item.Name</h6>
                                    <p class="card-text small text-muted">@item.Description</p>

                                    <div class="mb-2">
                                        <span class="badge bg-secondary">–ê—Ä—Ç–∏–∫—É–ª: @item.ItemCode</span>
                                        @if (isMyItem)
                                        {
                                            <span class="badge bg-success ms-1">üë§ –í–∞—à —Ç–æ–≤–∞—Ä</span>
                                        }
                                    </div>

                                    <div class="mb-2 d-flex justify-content-between">
                                        <div>
                                            <small class="text-muted">
                                                –†–µ–¥–∫–æ—Å—Ç—å: <span class="@GetRarityClass(item.Rarity)">@item.Rarity</span>
                                            </small>
                                        </div>
                                        <div>
                                            <small class="text-muted">
                                                –ö–∞—Ç–µ–≥–æ—Ä–∏—è: <span class="badge bg-info">@GetCategoryName(item.Category)</span>
                                            </small>
                                        </div>
                                    </div>

                                    <div class="mb-2">
                                        <small class="text-muted">
                                            –û—Å—Ç–∞—Ç–æ–∫: <span class="@GetQuantityClass(item.Quantity)">@item.Quantity —à—Ç.</span>
                                        </small>
                                    </div>

                                    <div class="d-flex justify-content-between align-items-center mt-3">
                                        @if (item.Quantity > 0)
                                        {
                                            <strong style="font-size: 18px;">@item.Price.ToString("N2") ‚ÇΩ</strong>
                                        }
                                        else
                                        {
                                            <strong style="font-size: 18px; color: #dc3545;">–¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è</strong>
                                        }
                                        <span class="badge @GetCategoryBadgeClass(item.Category)">
                                            @GetCategoryIcon(item.Category)
                                        </span>
                                    </div>
                                </div>

                                <div class="card-footer bg-white">
                                    @if (item.Quantity > 0)
                                    {
                                        <div class="input-group input-group-sm mb-2">
                                            <input type="number" class="form-control" value="1" min="1" max="@item.Quantity" id="qty_@item.Id">
                                            <button class="btn btn-primary" type="button" onclick="addToCart(@item.Id, '@item.Name.Replace("'", "\\'")', @item.Price.ToString("F2").Replace(",", "."), document.getElementById('qty_@item.Id').value, @item.Quantity)">
                                                üõí –î–æ–±–∞–≤–∏—Ç—å
                                            </button>
                                        </div>
                                        <div class="text-center">
                                            <small class="text-muted">–ú–∞–∫—Å–∏–º—É–º: @item.Quantity —à—Ç.</small>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="alert alert-warning text-center py-2 mb-0">
                                            <i class="fas fa-exclamation-triangle"></i> –¢–æ–≤–∞—Ä –∑–∞–∫–æ–Ω—á–∏–ª—Å—è
                                        </div>
                                    }

                                    @if (isMyItem)
                                    {
                                        <div class="mt-2">
                                            <button class="btn btn-sm btn-outline-primary w-100" onclick="window.location.href='/myitems'">
                                                <i class="fas fa-edit"></i> –£–ø—Ä–∞–≤–ª—è—Ç—å
                                            </button>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="col-12">
                        <div class="alert alert-info">
                            üì¶ –¢–æ–≤–∞—Ä—ã —Å–∫–æ—Ä–æ –ø–æ—è–≤—è—Ç—Å—è. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∫–∞—Ç–∞–ª–æ–≥...
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<script>
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.addEventListener('DOMContentLoaded', function() {
        updateCartDisplay();
        updateUserBalance();
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ò–ó –ë–ê–ó–´ –î–ê–ù–ù–´–•
    async function updateUserBalance() {
        try {
            const response = await fetch('/api/account/me');

            if (response.status === 401) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
                document.getElementById('userBalance').textContent = '0';
                return;
            }

            const data = await response.json();

            if (data.user) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
                const balance = data.user.balance || 0;
                document.getElementById('userBalance').textContent = balance;

                // –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage
                const currentUser = JSON.parse(localStorage.getItem('user')) || {};
                currentUser.balance = balance;
                localStorage.setItem('user', JSON.stringify(currentUser));
            } else {
                document.getElementById('userBalance').textContent = '0';
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –±–∞–ª–∞–Ω—Å–∞:', error);
            document.getElementById('userBalance').textContent = '–û—à–∏–±–∫–∞';
        }
    }

    function addToCart(id, name, price, quantity, maxQuantity) {
        quantity = parseInt(quantity) || 1;
        maxQuantity = parseInt(maxQuantity) || 999;

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –æ—Å—Ç–∞—Ç–æ–∫
        if (quantity > maxQuantity) {
            showAlert(`–î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ ${maxQuantity} —à—Ç. —Ç–æ–≤–∞—Ä–∞ "${name}"`, 'warning');
            document.getElementById('qty_' + id).value = maxQuantity;
            return;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–æ–ª—å—à–µ 0
        if (quantity <= 0) {
            showAlert('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ 0', 'warning');
            return;
        }

        const existingItem = cart.find(i => i.id === id);

        if (existingItem) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—Ä–µ–≤—ã—Å–∏—Ç –ª–∏ –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Å—Ç–∞—Ç–æ–∫
            const newTotalQuantity = existingItem.quantity + quantity;
            if (newTotalQuantity > maxQuantity) {
                showAlert(`–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ ${maxQuantity} —à—Ç. —Ç–æ–≤–∞—Ä–∞ "${name}"`, 'warning');
                return;
            }
            existingItem.quantity += quantity;
        } else {
            cart.push({ id, name, price: parseFloat(price), quantity, maxQuantity });
        }

        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
        showAlert(`"${name}" –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É! (${quantity} —à—Ç.)`);
    }

    function updateCartDisplay() {
        let html = '';
        let total = 0;

        if (cart.length === 0) {
            html = '<p class="text-muted text-center">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
        } else {
            cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                html += `
                    <div class="mb-3 pb-3 border-bottom">
                        <div class="d-flex justify-content-between">
                            <div>
                                <strong>${item.name}</strong>
                                <p class="text-muted small mb-1">${item.price.toFixed(2)} ‚ÇΩ √ó ${item.quantity} —à—Ç.</p>
                                <small class="text-info">–ú–∞–∫—Å: ${item.maxQuantity} —à—Ç.</small>
                            </div>
                            <button class="btn btn-sm btn-outline-danger" onclick="removeFromCart(${index})">‚úï</button>
                        </div>
                        <div class="text-end">
                            <strong>${itemTotal.toFixed(2)} ‚ÇΩ</strong>
                        </div>
                    </div>
                `;
                total += itemTotal;
            });
        }

        document.getElementById('cartItemsList').innerHTML = html;
        document.getElementById('cartTotal').textContent = total.toFixed(2) + ' ‚ÇΩ';
    }

    function removeFromCart(index) {
        cart.splice(index, 1);
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartDisplay();
    }

    function clearCart() {
        if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) {
            cart = [];
            localStorage.removeItem('cart');
            updateCartDisplay();
        }
    }

    async function checkout() {
        const user = JSON.parse(localStorage.getItem('user'));
        if (!user || !user.id) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞');
            window.location.href = '/';
            return;
        }

        if (cart.length === 0) {
            alert('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞!');
            return;
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
        const insufficientItems = [];
        for (const item of cart) {
            // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å —Å–µ—Ä–≤–µ—Ä–∞
            if (item.quantity > item.maxQuantity) {
                insufficientItems.push(item.name);
            }
        }

        if (insufficientItems.length > 0) {
            alert(`–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑:\n${insufficientItems.map(name => `- ${name}`).join('\n')}\n\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å, –æ–±–Ω–æ–≤–∏—Ç–µ –∫–æ—Ä–∑–∏–Ω—É.`);
            return;
        }

        try {
            const response = await fetch('/api/order/create', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ items: cart })
            });

            const data = await response.json();

            if (response.ok) {
                showAlert(data.message || '–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω', 'success');

                // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –æ–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ü–û–°–õ–ï –ø–æ–∫—É–ø–∫–∏
                await updateUserBalance();

                cart = [];
                localStorage.removeItem('cart');
                updateCartDisplay();

                // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                setTimeout(() => {
                    location.reload();
                }, 1500);
            } else {
                showAlert(data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞', 'danger');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            showAlert('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ –∑–∞–∫–∞–∑–∞', 'danger');
        }
    }

    function filterItems() {
        const searchText = document.getElementById('searchText').value.toLowerCase();
        const searchArticle = document.getElementById('searchArticle').value.toLowerCase();
        const category = document.getElementById('categoryFilter').value;
        const rarity = document.getElementById('rarityFilter').value;

        document.querySelectorAll('.game-item').forEach(item => {
            const name = item.dataset.name;
            const article = item.dataset.article;
            const itemCategory = item.dataset.category;
            const itemRarity = item.dataset.rarity;

            const matchText = searchText === '' || name.includes(searchText);
            const matchArticle = searchArticle === '' || article.includes(searchArticle);
            const matchCategory = !category || itemCategory === category;
            const matchRarity = !rarity || itemRarity === rarity;

            item.style.display = matchText && matchArticle && matchCategory && matchRarity ? '' : 'none';
        });
    }

    function search() {
        filterItems();
    }

    function resetFilters() {
        document.getElementById('searchText').value = '';
        document.getElementById('searchArticle').value = '';
        document.getElementById('categoryFilter').value = '';
        document.getElementById('rarityFilter').value = '';
        filterItems();
    }

    function showAlert(msg, type = 'success') {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –∞–ª–µ—Ä—Ç—ã
        document.querySelectorAll('.alert-dismissible').forEach(alert => alert.remove());

        const alert = document.createElement('div');
        alert.className = `alert alert-${type} alert-dismissible fade show`;
        alert.style.position = 'fixed';
        alert.style.top = '80px';
        alert.style.right = '20px';
        alert.style.zIndex = '9999';
        alert.style.minWidth = '300px';
        alert.innerHTML = `${msg}<button type="button" class="btn-close" data-bs-dismiss="alert"></button>`;
        document.body.appendChild(alert);
        setTimeout(() => {
            if (alert.parentNode) {
                alert.remove();
            }
        }, 5000);
    }

    // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    window.addEventListener('focus', updateUserBalance);
</script>

@functions {
    private string GetIcon(string category)
    {
        return category switch
        {
            "Weapon" => "‚öîÔ∏è",
            "Armor" => "üõ°Ô∏è",
            "Potion" => "üß™",
            "Accessory" => "üíé",
            _ => "üì¶"
        };
    }

    private string GetCategoryIcon(string category)
    {
        return category switch
        {
            "Weapon" => "‚öîÔ∏è",
            "Armor" => "üõ°Ô∏è",
            "Potion" => "üß™",
            "Accessory" => "üíé",
            _ => "üì¶"
        };
    }

    private string GetCategoryName(string category)
    {
        return category switch
        {
            "Weapon" => "–û—Ä—É–∂–∏–µ",
            "Armor" => "–ë—Ä–æ–Ω—è",
            "Potion" => "–ó–µ–ª—å—è",
            "Accessory" => "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã",
            "Other" => "–î—Ä—É–≥–æ–µ",
            _ => category
        };
    }

    private string GetRarityClass(string rarity)
    {
        return rarity switch
        {
            "Legendary" => "badge bg-warning",
            "Mythical" => "badge bg-danger",
            "Epic" => "badge bg-primary",
            "Rare" => "badge bg-info",
            "Uncommon" => "badge bg-success",
            _ => "badge bg-secondary"
        };
    }

    private string GetCategoryBadgeClass(string category)
    {
        return category switch
        {
            "Weapon" => "bg-danger",
            "Armor" => "bg-success",
            "Potion" => "bg-purple",
            "Accessory" => "bg-warning",
            "Other" => "bg-secondary",
            _ => "bg-secondary"
        };
    }

    private string GetQuantityClass(int quantity)
    {
        return quantity switch
        {
            <= 0 => "badge bg-danger",
            <= 5 => "badge bg-warning",
            <= 20 => "badge bg-info",
            _ => "badge bg-success"
        };
    }
}